<div class="max-w-md mx-auto p-6">
  <%# 1. LINE連携済みかどうかで分岐 %>
  <% if @user.line_user_id.present? %>
    
    <h2 class="text-xl font-black mb-6">LINE通知設定</h2>

    <%= form_with model: @user, url: notification_path, method: :patch do |f| %>
      <%# 通知のON/OFF %>
      <div class="mb-6 p-4 bg-stone-50 rounded-2xl flex justify-between items-center">
        <span class="font-bold">通知を有効にする</span>
        <%= f.check_box :notification_enabled, class: "w-6 h-6 rounded text-[#06C755]" %>
      </div>

      <%# 曜日選択（一部抜粋） %>
      <div class="mb-6">
        <p class="text-sm font-bold text-stone-400 mb-2">配信曜日</p>
        <div class="grid grid-cols-7 gap-1">
          <% [:mon, :tue, :wed, :thu, :fri, :sat, :sun].each do |day| %>
            <label>
              <%= f.check_box "subscribe_#{day}", class: "hidden peer" %>
              <div class="py-2 text-center border rounded-lg peer-checked:bg-[#06C755] peer-checked:text-white">
                <%= t("date.abbr_day_names")[[:sun, :mon, :tue, :wed, :thu, :fri, :sat].index(day)] %>
              </div>
            </label>
          <% end %>
        </div>
      </div>

      <%# 時間設定 %>
      <div class="mb-8">
        <p class="text-sm font-bold text-stone-400 mb-2">配信時間</p>
        <%= f.time_field :notification_time, class: "w-full p-3 border rounded-xl" %>
      </div>

      <%= f.submit "保存する", class: "w-full py-4 bg-orange-500 text-white font-black rounded-2xl" %>
    <% end %>

  <% else %>
    <%# 2. 未連携（主にGoogleユーザー）の場合 %>
    <div class="text-center py-10">
      <div class="bg-[#06C755]/10 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
        <svg class="w-10 h-10 text-[#06C755]" ...> </svg>
      </div>
      <h2 class="text-lg font-black mb-2">LINE通知を使いませんか？</h2>
      <p class="text-sm text-stone-500 mb-8">
        LINEと連携すると、設定した時間に<br>レシピの通知を受け取れます。
      </p>
      
      <%# LINE連携ボタン（実体はLINEログインと同じURLを叩かせる） %>
      <%= button_to "LINEと連携する", "/auth/line", 
          method: :post, 
          data: { turbo: false },
          class: "w-full py-4 bg-[#06C755] text-white font-black rounded-2xl shadow-lg" %>
    </div>
  <% end %>
</div>