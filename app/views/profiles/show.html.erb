<div class="h-60 bg-gradient-to-br from-orange-200 via-orange-400 to-red-500 relative overflow-hidden">
  <div class="absolute -right-10 -bottom-10 w-64 h-64 bg-white/10 rounded-full blur-3xl"></div>
  <div class="absolute left-1/4 top-0 w-32 h-32 bg-yellow-300/10 rounded-full blur-2xl"></div>
  
  <div class="absolute inset-0 flex flex-col justify-between items-end p-6 pb-16">
    <div class="bg-white/20 backdrop-blur-md border border-white/30 rounded-full px-4 py-1.5 shadow-sm">
      <div class="flex items-center gap-2">
        <span class="text-lg"><%= @user.cooking_rank[:icon] %></span>
        <span class="text-white font-black text-xs tracking-widest uppercase"><%= @user.cooking_rank[:name] %></span>
      </div>
    </div>

    <div class="text-right text-white drop-shadow-lg">
      <div class="mb-3">
        <p class="text-[10px] font-bold opacity-90 uppercase tracking-[0.2em] mt-3 mb-1">Total Savings</p>
        <div class="flex items-baseline justify-end">
          <span class="text-xl font-bold mr-1">¥</span>
          <span class="text-5xl font-black tracking-tighter tabular-nums">
            <%= number_with_delimiter(@user.total_savings) %>
          </span>
        </div>
      </div>
      
      <div class="flex items-baseline justify-end opacity-90">
        <p class="text-[10px] font-bold uppercase tracking-[0.2em] mr-3">Total Cooked</p>
        <span class="text-2xl font-black"><%= @user.total_cooking_count %></span>
        <span class="text-sm font-bold ml-1">回</span>
      </div>
    </div>
  </div>
</div>

    <div class="relative px-10 pb-10">
      <div class="relative -top-12 flex justify-between items-end">
        <div class="p-1 bg-white rounded-full">
          <% if @user.avatar.attached? %>
            <%= image_tag @user.avatar, class: "w-32 h-32 rounded-full object-cover border-4 border-white shadow-sm" %>
          <% else %>
            <div class="w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center text-4xl border-4 border-white shadow-sm">👤</div>
          <% end %>
        </div>
        <%= link_to "編集する", edit_profile_path, class: "mb-2 bg-white border border-gray-300 px-4 py-2 rounded-lg text-sm font-bold hover:bg-gray-50 transition shadow-sm" %>
      </div>

      <div class="-mt-8">
        <h1 class="text-2xl font-bold text-gray-900"><%= @user.name %></h1>
        <p class="text-gray-500 text-sm"><%= @user.email %></p>
      </div>

      <hr class="my-6 border-gray-100">

      <%# 統計情報エリア %>
<div class="grid grid-cols-2 gap-4 mb-8">
        <%# 今月の節約額カード %>
        <div class="bg-orange-50 p-6 rounded-2xl text-center shadow-sm border border-orange-100/50">
          <p class="text-gray-500 text-[10px] uppercase font-bold tracking-[0.15em] mb-2">今月の節約額</p>
          <div class="flex items-baseline justify-center text-orange-600">
            <span class="text-lg font-bold mr-0.5">¥</span>
            <span class="text-4xl md:text-5xl font-black tabular-nums tracking-tight">
              <%= number_with_delimiter(@user.savings_this_month) %>
            </span>
          </div>
        </div>

        <%# 今月の自炊回数カード %>
        <div class="bg-emerald-50 p-6 rounded-2xl text-center shadow-sm border border-emerald-100/50">
          <p class="text-gray-500 text-[10px] uppercase font-bold tracking-[0.15em] mb-2">今月の自炊回数</p>
          <div class="flex items-baseline justify-center text-emerald-600">
            <span class="text-4xl md:text-5xl font-black tabular-nums tracking-tight">
              <%= @user.count_this_month %>
            </span>
            <span class="text-sm font-bold ml-1">回</span>
          </div>
        </div>
      </div>
      
      <%# 月別の集計結果リスト %>
      <h3 class="text-lg font-bold text-gray-800 mb-4 px-1">月別の自炊実績</h3>
      <div class="space-y-3 mb-8">
        <% @monthly_stats.each do |stat| %>
          <div class="flex items-center justify-between p-4 bg-white border border-gray-100 rounded-2xl shadow-sm hover:shadow-md transition-shadow">
            <div class="font-bold text-gray-700">
              <%# 月の表示（SQLite/PostgreSQL両対応のための考慮） %>
              <%= stat.month.to_date.strftime("%Y年 %m月") rescue stat.month %>
            </div>
            <div class="flex gap-6">
              <div class="text-right">
                <p class="text-[9px] text-gray-400 font-bold uppercase">Savings</p>
                <p class="text-emerald-600 font-black">¥<%= number_with_delimiter(stat.savings.to_i) %></p>
              </div>
              <div class="text-right border-l pl-6 border-gray-100">
                <p class="text-[9px] text-gray-400 font-bold uppercase">Cooked</p>
                <p class="text-gray-900 font-black"><%= stat.count %><span class="text-[10px] ml-0.5">回</span></p>
              </div>
            </div>
          </div>
        <% end %>

        <% if @monthly_stats.empty? %>
          <div class="text-center py-10 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200">
            <p class="text-gray-400 text-sm">まだ記録がありません。自炊して記録してみましょう！</p>
          </div>
        <% end %>
      </div>

      <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 mb-8">
        <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
          <span>📈</span> 自炊節約の歩み
        </h3>
      <div class="w-full aspect-video md:aspect-[2/1]">
          <canvas id="savingsChart" 
                  data-labels="<%= @chart_labels.to_json %>" 
                  data-values="<%= @chart_values.to_json %>">
          </canvas>
        </div>
      </div>
    </div>
  </div>
</div>