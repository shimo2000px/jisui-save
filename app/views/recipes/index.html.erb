<div class="max-w-6xl mx-auto mt-6 md:mt-10 mb-20 px-4">
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 md:mb-12 gap-6">
    <div>
      <h1 class="text-2xl md:text-3xl font-black text-stone-800 tracking-tight flex items-center gap-2">
        <span class="text-orange-500 text-3xl md:text-4xl">
          <%= @current_filter == "mine" ? "ü•ò" : "ü•ó" %>
        </span>
        <%= @current_filter == "mine" ? "MY„É¨„Ç∑„Éî" : "„Åø„Çì„Å™„ÅÆ„É¨„Ç∑„Éî" %>
      </h1>
      <p class="text-stone-400 text-xs md:text-sm mt-1 font-medium">
        <%= @current_filter == "mine" ? "„ÅÇ„Å™„Åü„Åå‰ΩúÊàê„Åó„ÅüÁØÄÁ¥Ñ„ÅÆË®òÈå≤" : "„Åä„ÅÑ„Åó„ÅèË≥¢„ÅèÁØÄÁ¥ÑÔºÅ„Åø„Çì„Å™„ÅÆÂÖ¨Èñã„É¨„Ç∑„Éî" %>
      </p>
    </div>

    <div class="flex items-center gap-3 w-full md:w-auto">
      <div class="flex flex-1 md:flex-none bg-orange-100/50 p-1.5 rounded-2xl shadow-inner">
        <%= link_to "ÂÖ¨Èñã„É¨„Ç∑„Éî", recipes_path(filter: "public"), 
            class: "flex-1 md:flex-none md:w-32 py-2.5 rounded-xl text-xs md:text-sm font-bold text-center transition-all #{@current_filter == "public" ? "bg-white text-orange-600 shadow-sm" : "text-stone-400 hover:text-orange-500"}" %>
        <%= link_to "MY„É¨„Ç∑„Éî", recipes_path(filter: "mine"), 
            class: "flex-1 md:flex-none md:w-32 py-2.5 rounded-xl text-xs md:text-sm font-bold text-center transition-all #{@current_filter == "mine" ? "bg-white text-orange-600 shadow-sm" : "text-stone-400 hover:text-orange-500"}" %>
      </div>

      <%= link_to new_recipe_path, class: "inline-flex items-center px-5 py-3 font-bold text-white bg-orange-500 rounded-2xl hover:bg-orange-600 shadow-lg shadow-orange-100 transition-all text-sm active:scale-95" do %>
        <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 4v16m8-8H4"></path></svg>
        ‰Ωú„Çã
        <% if guest_user? %>
          <span class="text-[10px] opacity-70 ml-1">(Ë¶ÅÁôªÈå≤)</span>
        <% end %>
      <% end %>
    </div>
  </div>

  <div class="grid grid-cols-2 lg:grid-cols-3 gap-4 md:gap-10">
    <% if @recipes.any? %>
      <% @recipes.each_with_index do |recipe, index| %>
          
          <div class="animate-fade-in-up bg-white rounded-[2rem] border border-orange-50 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group relative overflow-hidden"
              style="animation-delay: <%= index * 0.1 %>s; opacity: 0; animation-fill-mode: forwards;">
              
            <div class="relative overflow-hidden aspect-square md:aspect-[4/3]"> 
              <%= link_to recipe_path(recipe) do %>
                <% if recipe.image.attached? %>
                  <%= image_tag recipe.image, class: "w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" %>
                <% else %>
                  <%= image_tag "default_recipe.png", class: "w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-80" %>
                  <div class="absolute inset-0 flex items-center justify-center">
                    <span class="bg-white/60 backdrop-blur-sm px-3 py-1 rounded-full text-[10px] font-bold text-orange-400">NO IMAGE</span>
                  </div>
                <% end %>
              <% end %>
            
            <div class="absolute top-2 left-2 md:top-4 md:left-4 bg-white/90 backdrop-blur-md text-orange-600 py-1 px-2.5 md:py-1.5 md:px-4 rounded-xl shadow-lg border border-orange-100 flex items-center gap-1">
              <span class="text-[8px] md:text-[10px] font-black uppercase tracking-tighter opacity-70">ÁØÄÁ¥ÑÈ°ç</span>
              <span class="text-xs md:text-xl font-black">¬•<%= number_with_delimiter(recipe.savings_amount) %></span>
            </div>

            <% if @current_filter == "mine" && !recipe.is_public? %>
              <div class="absolute top-2 right-2 bg-stone-900/40 backdrop-blur-md text-white p-2 rounded-xl shadow-sm">
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                </svg>
              </div>
            <% end %>
          </div>

          <div class="p-4 md:p-6 flex-grow flex flex-col">
            <h2 class="text-sm md:text-xl font-black text-stone-800 mb-3 line-clamp-2 md:line-clamp-none transition-colors group-hover:text-orange-600">
              <%= link_to recipe.title, recipe_path(recipe) %>
            </h2>
            
            <div class="mt-auto p-3 bg-[#FFFBF7] rounded-2xl border border-orange-100/50">
              <div class="flex justify-between items-baseline border-b border-orange-100/30 pb-1.5 mb-1.5">
                <span class="text-[8px] md:text-[10px] text-stone-400 font-bold uppercase tracking-widest">Ëá™ÁÇä</span>
                <span class="text-xs md:text-lg font-black text-stone-700">
                  ¬•<%= number_with_delimiter(recipe.total_cost) %>
                </span>
              </div>
              
              <div class="flex justify-between items-baseline">
                <span class="text-[8px] md:text-[10px] text-stone-400 font-bold uppercase truncate mr-1 max-w-[60px] md:max-w-[100px]">
                  <%= recipe.convenience_food&.name || "Â§ñÈ£ü" %>
                </span>
                <span class="text-[10px] md:text-sm font-bold text-stone-300 line-through">
                  ¬•<%= number_with_delimiter(recipe.convenience_food&.price || 0) %>
                </span>
              </div>
            </div>
          </div>

          <div class="p-4 pt-0">
            <%= render "cooking_button", recipe: recipe %>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="col-span-full py-24 text-center">
        <div class="text-5xl mb-4">üçΩÔ∏è</div>
        <p class="text-stone-400 font-bold">Ë°®Á§∫„Åß„Åç„Çã„É¨„Ç∑„Éî„Åå„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</p>
      </div>
    <% end %>
  </div>

  <div class="mt-16 mb-12 flex justify-center">
    <%= paginate @recipes %>
  </div>
</div>