<div class="max-w-6xl mx-auto mt-6 md:mt-10 mb-20 px-4">
  
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 md:mb-12 gap-6">
    <div>
      <h1 class="text-2xl md:text-3xl font-black text-stone-800 tracking-tight flex items-center gap-2">
        <span class="text-orange-500 text-3xl md:text-4xl">
          <%= @current_filter == "mine" ? "ü•ò" : "ü•ó" %>
        </span>
        <%= @current_filter == "mine" ? "MY„É¨„Ç∑„Éî" : "ÂÖ¨Èñã„É¨„Ç∑„Éî" %>
      </h1>
      <p class="text-stone-400 text-xs md:text-sm mt-1 font-medium">
        <%= @current_filter == "mine" ? "„ÅÇ„Å™„Åü„Åå‰ΩúÊàê„Åó„ÅüÁØÄÁ¥Ñ„ÅÆË®òÈå≤" : "„Åä„ÅÑ„Åó„ÅèË≥¢„ÅèÁØÄÁ¥ÑÔºÅ„Åø„Çì„Å™„ÅÆÂÖ¨Èñã„É¨„Ç∑„Éî" %>
      </p>
    </div>

    <div class="flex items-center gap-3 w-full md:w-auto">
      <div class="flex flex-1 md:flex-none bg-orange-100/50 p-1.5 rounded-2xl shadow-inner">
        <%= link_to "ÂÖ¨Èñã„É¨„Ç∑„Éî", recipes_path(filter: "public"), 
            class: "flex-1 md:flex-none md:w-32 py-2.5 rounded-xl text-xs md:text-sm font-bold text-center transition-all #{@current_filter == "public" ? "bg-white text-orange-600 shadow-sm" : "text-stone-400 hover:text-orange-500"}" %>
        <%= link_to "MY„É¨„Ç∑„Éî", recipes_path(filter: "mine"), 
            class: "flex-1 md:flex-none md:w-32 py-2.5 rounded-xl text-xs md:text-sm font-bold text-center transition-all #{@current_filter == "mine" ? "bg-white text-orange-600 shadow-sm" : "text-stone-400 hover:text-orange-500"}" %>
      </div>

      <%= link_to new_recipe_path, class: "inline-flex items-center px-5 py-3 font-bold text-white bg-orange-500 rounded-2xl hover:bg-orange-600 shadow-lg shadow-orange-100 transition-all text-sm active:scale-95" do %>
        <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 4v16m8-8H4"></path></svg>
        ‰Ωú„Çã
      <% end %>
    </div>
  </div>

  <div class="bg-white p-6 rounded-[2.5rem] shadow-sm border border-orange-50 mb-8">
    <%= search_form_for @q, class: "space-y-4" do |f| %>
      <%= hidden_field_tag :filter, @current_filter %>
      
      <div class="flex flex-col md:flex-row gap-3">
        <div class="relative flex-1">
          <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
          </div>
          <%= f.search_field :title_or_description_cont, 
              placeholder: "ÊñôÁêÜÂêç„ÇÑ„Ç≠„Éº„ÉØ„Éº„Éâ„ÅßÊ§úÁ¥¢...", 
              class: "block w-full pl-12 pr-4 py-3 border-none bg-stone-100 rounded-2xl focus:ring-2 focus:ring-orange-500 sm:text-sm font-bold text-stone-700" %>
        </div>
        <%= f.submit "Ê§úÁ¥¢", class: "btn bg-orange-500 hover:bg-orange-600 text-white border-none rounded-2xl px-8 font-black shadow-lg shadow-orange-100 transition-all active:scale-95" %>
      </div>

      <div class="flex flex-wrap items-center gap-4 text-xs md:text-sm font-bold text-stone-500 px-2">
        <span class="text-stone-300">‰∏¶„Å≥Êõø„ÅàÔºö</span>
        <%= sort_link(@q, :created_at, "Êñ∞ÁùÄÈ†Ü", default_order: :desc, class: "hover:text-orange-600 transition-colors") %>
        <span class="text-stone-200">|</span>
        <%= sort_link(@q, :cooking_records_count, "‰∫∫Ê∞óÈ†Ü", default_order: :desc, class: "hover:text-orange-600 transition-colors") %>
      </div>
    <% end %>
  </div>



  <div class="grid grid-cols-2 lg:grid-cols-3 gap-4 md:gap-10">
    <% if @recipes.any? %>
      <% @recipes.each_with_index do |recipe, index| %>
        <div class="animate-fade-in-up bg-white rounded-[2rem] border border-orange-50 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group relative overflow-hidden flex flex-col"
            style="animation-delay: <%= index * 0.1 %>s; opacity: 0; animation-fill-mode: forwards;">
            <div class="relative overflow-hidden aspect-square md:aspect-[4/3]"> 
              <%= link_to recipe_path(recipe) do %>
                <% if recipe.image.attached? %>
                  <%= image_tag recipe.image, class: "w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" %>
                <% else %>
                  <%= image_tag "default_recipe.png", class: "w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-80" %>
                <% end %>
              <% end %>
              <div class="absolute top-2 left-2 md:top-4 md:left-4 bg-white/90 backdrop-blur-md text-orange-600 py-1 px-2.5 md:py-1.5 md:px-4 rounded-xl shadow-lg border border-orange-100 flex items-center gap-1">
                <span class="text-[8px] md:text-[10px] font-black uppercase tracking-tighter opacity-70">ÁØÄÁ¥ÑÈ°ç</span>
                <span class="text-xs md:text-xl font-black">¬•<%= number_with_delimiter(recipe.savings_amount) %></span>
              </div>
            </div>

            <div class="p-4 md:p-6 flex-grow flex flex-col">
              <h2 class="text-sm md:text-xl font-black text-stone-800 mb-3 line-clamp-2 transition-colors group-hover:text-orange-600">
                <%= link_to recipe.title, recipe_path(recipe) %>
              </h2>
              <div class="mt-auto p-3 bg-[#FFFBF7] rounded-2xl border border-orange-100/50">
                <div class="flex justify-between items-baseline border-b border-orange-100/30 pb-1.5 mb-1.5">
                  <span class="text-[8px] md:text-[10px] text-stone-400 font-bold tracking-widest uppercase">Ëá™ÁÇä</span>
                  <span class="text-xs md:text-lg font-black text-stone-700">¬•<%= number_with_delimiter(recipe.total_cost) %></span>
                </div>
                <div class="flex justify-between items-baseline">
                  <span class="text-[8px] md:text-[10px] text-stone-400 font-bold truncate mr-1 max-w-[60px] md:max-w-[100px] uppercase">
                    <%= recipe.convenience_food&.name || "Â§ñÈ£ü" %>
                  </span>
                  <span class="text-[10px] md:text-sm font-bold text-stone-300 line-through">¬•<%= number_with_delimiter(recipe.convenience_food&.price || 0) %></span>
                </div>
              </div>
            </div>
            <div class="p-4 pt-0">
              <%= render "cooking_button", recipe: recipe %>
            </div>
        </div>
      <% end %>
    <% else %>
      <div class="col-span-full py-24 text-center">
        <div class="text-5xl mb-4">üçΩÔ∏è</div>
        <p class="text-stone-400 font-bold">Ë°®Á§∫„Åß„Åç„Çã„É¨„Ç∑„Éî„Åå„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</p>
      </div>
    <% end %>
  </div>

  <div class="mt-16 mb-12 flex justify-center">
    <%= paginate @recipes %>
  </div>
</div>